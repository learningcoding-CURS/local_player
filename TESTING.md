# 测试指南

## 测试环境准备

### 1. 准备测试设备
- Android 8.0+ 物理设备（推荐）
- 或 Android 模拟器（API 26+）

### 2. 准备测试媒体文件
在设备上准备以下测试文件：
- 横屏视频 (16:9)：test_landscape.mp4
- 竖屏视频 (9:16)：test_portrait.mp4
- 音频文件：test_audio.mp3
- 字幕文件：test_subtitle.srt
- 文稿文件：test_transcript.txt

---

## 手动测试步骤

### 测试 1: 基础播放功能

#### 步骤
1. 启动应用
2. 点击 "+" 按钮
3. 选择一个视频文件
4. 点击播放

#### 预期结果
- ✅ 视频正常播放
- ✅ 显示播放控制界面
- ✅ 进度条正常更新
- ✅ 显示正确的时长

---

### 测试 2: 倍速播放

#### 步骤
1. 播放视频
2. 点击倍速按钮（1.0x）
3. 依次选择不同倍速：0.75x, 1.25x, 1.5x, 2.0x, 2.5x, 3.0x
4. 观察播放速度变化

#### 预期结果
- ✅ 倍速菜单正确显示
- ✅ 当前倍速高亮显示
- ✅ 播放速度准确切换
- ✅ 音频音调正常（不变形）

---

### 测试 3: 长按临时加速

#### 步骤
1. 播放视频（当前倍速 1.0x）
2. 长按屏幕任意位置
3. 保持长按 3 秒
4. 松开手指

#### 预期结果
- ✅ 长按时显示 "2.5x" 提示
- ✅ 播放速度立即切换到 2.5x
- ✅ 松开后恢复到 1.0x
- ✅ 提示消失

#### 步骤（高级）
1. 将倍速设置为 1.5x
2. 长按屏幕
3. 松开手指

#### 预期结果
- ✅ 长按时切换到 2.5x
- ✅ 松开后恢复到 1.5x（而不是 1.0x）

---

### 测试 4: 双击跳转

#### 步骤
1. 播放视频
2. 双击屏幕左半部分
3. 观察时间变化
4. 双击屏幕右半部分
5. 观察时间变化

#### 预期结果
- ✅ 左侧双击后退 15 秒
- ✅ 右侧双击前进 15 秒
- ✅ 进度条同步更新
- ✅ 可连续双击

---

### 测试 5: 亮度调节

#### 步骤
1. 播放视频
2. 在屏幕左半部分向上滑动
3. 观察屏幕亮度变化
4. 向下滑动
5. 观察屏幕亮度变化

#### 预期结果
- ✅ 显示亮度指示器
- ✅ 向上滑动亮度增加
- ✅ 向下滑动亮度降低
- ✅ 显示百分比（0-100%）
- ✅ 指示器自动隐藏

---

### 测试 6: 音量调节

#### 步骤
1. 播放视频
2. 在屏幕右半部分向上滑动
3. 观察音量变化
4. 向下滑动
5. 观察音量变化

#### 预期结果
- ✅ 显示音量指示器
- ✅ 向上滑动音量增加
- ✅ 向下滑动音量降低
- ✅ 系统音量同步变化
- ✅ 指示器自动隐藏

---

### 测试 7: 锁屏模式

#### 步骤
1. 播放视频
2. 点击锁定按钮
3. 尝试点击屏幕
4. 尝试滑动屏幕
5. 点击解锁按钮

#### 预期结果
- ✅ 锁定后控制界面消失
- ✅ 锁定后手势失效
- ✅ 仅显示锁定图标
- ✅ 点击锁定图标解锁
- ✅ 解锁后功能恢复

---

### 测试 8: 横竖屏切换

#### 步骤（横屏视频）
1. 播放 16:9 横屏视频
2. 观察屏幕方向

#### 预期结果
- ✅ 自动切换到横屏模式
- ✅ 视频全屏显示

#### 步骤（竖屏视频）
1. 播放 9:16 竖屏视频
2. 观察屏幕方向

#### 预期结果
- ✅ 保持竖屏模式
- ✅ 视频适配屏幕

#### 步骤（音频）
1. 播放音频文件
2. 观察屏幕方向

#### 预期结果
- ✅ 始终保持竖屏
- ✅ 显示音频信息

---

### 测试 9: 后台播放

#### 步骤
1. 播放音频或视频
2. 按 Home 键返回桌面
3. 观察播放状态
4. 下拉通知栏
5. 查看播放通知

#### 预期结果
- ✅ 返回桌面后继续播放
- ✅ 通知栏显示播放信息
- ✅ 通知栏显示控制按钮
- ✅ 可通过通知栏控制播放
- ✅ 点击通知返回应用

---

### 测试 10: 播放进度保存

#### 步骤
1. 播放视频到中间位置（如 50%）
2. 按返回键退出播放
3. 重新点击该视频播放

#### 预期结果
- ✅ 从上次位置继续播放
- ✅ 进度条显示正确位置

---

## 性能测试

### 测试 11: 长时间播放

#### 步骤
1. 播放一个 2 小时以上的视频
2. 持续播放 30 分钟
3. 监控应用性能

#### 检查项
- ✅ 播放流畅无卡顿
- ✅ 内存占用稳定
- ✅ CPU 占用正常
- ✅ 设备温度正常
- ✅ 电池消耗合理

---

### 测试 12: 快速操作

#### 步骤
1. 播放视频
2. 快速连续点击前进按钮 10 次
3. 快速拖动进度条
4. 快速切换倍速

#### 预期结果
- ✅ 应用响应及时
- ✅ 无崩溃或卡顿
- ✅ 操作准确执行

---

## 异常测试

### 测试 13: 异常文件处理

#### 步骤
1. 尝试播放损坏的视频文件
2. 观察应用反应

#### 预期结果
- ✅ 显示友好的错误提示
- ✅ 应用不崩溃
- ✅ 可以返回列表

---

### 测试 14: 权限处理

#### 步骤
1. 在系统设置中撤销存储权限
2. 打开应用
3. 尝试添加媒体文件

#### 预期结果
- ✅ 提示需要权限
- ✅ 引导用户授权
- ✅ 授权后功能正常

---

## 兼容性测试

### 测试 15: 不同 Android 版本

#### 测试设备
- Android 8.0 设备
- Android 10 设备
- Android 13 设备

#### 检查项
- ✅ 应用正常安装
- ✅ 所有功能正常工作
- ✅ UI 显示正常
- ✅ 权限请求正常

---

### 测试 16: 不同屏幕尺寸

#### 测试设备
- 小屏手机（5.5 英寸）
- 大屏手机（6.7 英寸）
- 平板（10 英寸）

#### 检查项
- ✅ UI 布局适配
- ✅ 手势区域合理
- ✅ 文字大小适当
- ✅ 控件可点击

---

## 字幕与文稿测试

### 测试 17: SRT 字幕

#### 准备
创建 test.srt 文件：
```
1
00:00:01,000 --> 00:00:03,000
第一句字幕

2
00:00:03,500 --> 00:00:05,000
第二句字幕
```

#### 步骤
1. 播放视频
2. 加载 SRT 字幕文件
3. 观察字幕显示

#### 预期结果
- ✅ 字幕准确显示
- ✅ 时间同步正确
- ✅ 字幕切换流畅

---

### 测试 18: 文稿跳转

#### 准备
创建 test_transcript.txt 文件：
```
[00:00:15] 第一个时间点
[00:01:30] 第二个时间点
[00:02:45] 第三个时间点
```

#### 步骤
1. 播放媒体
2. 加载文稿文件
3. 点击不同时间点
4. 观察跳转

#### 预期结果
- ✅ 准确跳转到对应时间
- ✅ 当前时间点高亮显示
- ✅ 自动滚动到当前位置

---

## 测试报告模板

### 测试环境
- 设备型号：
- Android 版本：
- 应用版本：
- 测试日期：

### 测试结果汇总
| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 基础播放 | ✅ | ❌ | |
| 倍速播放 | ✅ | ❌ | |
| 长按加速 | ✅ | ❌ | |
| 手势控制 | ✅ | ❌ | |
| 横竖屏 | ✅ | ❌ | |
| 后台播放 | ✅ | ❌ | |
| 字幕显示 | ✅ | ❌ | |

### 发现的问题
1. 
2. 
3. 

### 建议改进
1. 
2. 
3. 

---

## 自动化测试（可选）

### 单元测试示例

```kotlin
@Test
fun testPlaybackSpeedChange() {
    val manager = ExoPlayerManager(context)
    manager.initialize()
    
    manager.setPlaybackSpeed(1.5f)
    assertEquals(1.5f, manager.playbackSpeed.value)
    
    manager.setPlaybackSpeed(2.0f)
    assertEquals(2.0f, manager.playbackSpeed.value)
}

@Test
fun testLongPressSpeedChange() {
    val manager = ExoPlayerManager(context)
    manager.initialize()
    
    manager.setPlaybackSpeed(1.0f)
    manager.startLongPress()
    assertEquals(2.5f, manager.playbackSpeed.value)
    
    manager.endLongPress()
    assertEquals(1.0f, manager.playbackSpeed.value)
}
```

---

## 测试清单快速检查

### 播放功能
- [ ] 播放/暂停
- [ ] 进度控制
- [ ] 前进/后退 15 秒
- [ ] 0.75x - 3.0x 倍速
- [ ] 长按 2.5x

### 手势功能
- [ ] 左侧双击后退
- [ ] 右侧双击前进
- [ ] 左侧滑动亮度
- [ ] 右侧滑动音量
- [ ] 锁屏模式

### 系统集成
- [ ] 横竖屏切换
- [ ] 后台播放
- [ ] 通知栏控制
- [ ] 进度保存

### 高级功能
- [ ] 字幕显示
- [ ] 文稿跳转
- [ ] 列表管理

---

**完成所有测试后，应用即可发布！** ✅

